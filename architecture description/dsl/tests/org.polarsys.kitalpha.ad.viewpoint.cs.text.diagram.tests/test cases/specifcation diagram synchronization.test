--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _cZrLsEK2Eea8mtDgosdpOA,_RuDWgEK2Eea8mtDgosdpOA
Element-Name: specifcation diagram synchronization
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _8EfCgEK0Eea8mtDgosdpOA
Runtime-Version: 2.0.2.201511100828
Save-Time: 7/7/16 10:44 AM
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

Test which checks if specification of diagram synchronization mode works
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

/*******************************************************************************
 * Copyright (c) 2016 THALES GLOBAL SERVICES.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *  
 * Contributors:
 *    Thales - initial API and implementation
 *******************************************************************************/
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.diagram.vptext" 
    | double-click
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 18 119
    key-type Enter
    key-type "M1+SPACE"
}
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 19 17
    key-type "M1+SPACE"
}
get-window -from "CompletionProposalPopup.createProposalSelector()" | get-table 
    | select "Synchronized - The Mapping Will Be always Synchronized" | click -default
get-editor "example.diagram.vptext" | get-text-viewer | get-property text | equals "/**\n"
    + " * Copyright (c) PolarSys, 2016. All rights reserved. \n"
    + " *\n"
    + " *\tViewpoint example\n"
    + " *\t@author: S0045853\n"
    + " *\t@date: 05/07/16\n"
    + " *\n"
    + " */\n \n"
    + "import external  \"platform:/plugin/org.eclipse.emf.ecoretools.design/description/ecore.odesign\"\n"
    + "Diagrams example.diagram {\n"
    + "\t\n"
    + "\tDiagram \"diagram_example\" {\n"
    + "\t\tdomain-context: external ecore.EClass\n"
    + "\t\tMapping {\n"
    + "\t\t\t\n"
    + "\t\t\tContainer containerExample {\n"
    + "\t\t\t\tdomain-context: external ecore.EAttribute provided-by association external ecore.EClass.eAllAttributes\n"
    + "\t\t\t\tSynchronized\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tLabel { content: Java getAttributeName police: black }\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tFlatStyle {\tborder: blue background: light_gray }\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t\tContains {\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\tNode newNode {\n"
    + "\t\t\t\t\t\tdomain-context: external ecore.EAnnotation provided-by association external ecore.EClass.eAllSuperTypes\n"
    + "\t\t\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\t\t\tLabel { content: \"example\" police: black alignment: center}\n"
    + "\t\t\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\t\t\tBasicStyle { border-color: black background: light_gray form: Square }\n"
    + "\t\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\tContains {\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t\tEdge newEdge {\n"
    + "\t\t\t\tassociation-context: external ecore.EAnnotation.contents\n"
    + "\t\t\t\tsource: containerExample\n"
    + "\t\t\t\ttarget: containerExample\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle { end-decorator: OutputArrow color: black }\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\tEdgeImport newEdgeImport {\n"
    + "\t\t\t\timport: EC_EReference\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tbegin-decorator: Diamond color: blue\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t}\n"
    + "\t\tActions{\n"
    + "\t\t\t//[Actions]\n"
    + "\t\t}\n"
    + "\t}\n"
    + "\t\n"
    + "}" | verify-true
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 19 18
    select-range 19 17 19 29
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property "getSelectionText()" | equals Synchronized 
    | verify-true
get-button "Save (M1+S)" | click

//Workaround to force the sync between text and vpdesc
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.spec.vptext" 
    | get-menu "Viewpoint DSL/Generate vpdesc file" | click
    
wait -ms 5000
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" 
    | double-click
get-editor "example.vpdesc" | get-tree 
    | get-item "platform:\\/resource\\/org.polarsys.kitalpha.vp.example.vpdsl\\/model\\/example.vpdesc/Viewpoint example/Diagram Set example.diagram/Diagram diagram_example/Mapping Set/Container containerExample" 
    | click
    
with [get-view Properties | get-tree] {
    get-item "Synchronization Mode" | get-property caption | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "values['Property']" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "values['Value']" | equals Synchronized | verify-true
    get-item "Synchronization Mode" | get-property "getData().getValueAsString()" | equals Synchronized | verify-true
}
get-editor "example.vpdesc" | close
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 30 128
    key-type Enter
    key-type "M1+SPACE"
    key-type Enter
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property text | equals "/**\n"
    + " * Copyright (c) PolarSys, 2016. All rights reserved. \n"
    + " *\n"
    + " *\tViewpoint example\n"
    + " *\t@author: S0045853\n"
    + " *\t@date: 05/07/16\n"
    + " *\n"
    + " */\n \n"
    + "import external  \"platform:/plugin/org.eclipse.emf.ecoretools.design/description/ecore.odesign\"\n"
    + "Diagrams example.diagram {\n"
    + "\t\n"
    + "\tDiagram \"diagram_example\" {\n"
    + "\t\tdomain-context: external ecore.EClass\n"
    + "\t\tMapping {\n"
    + "\t\t\t\n"
    + "\t\t\tContainer containerExample {\n"
    + "\t\t\t\tdomain-context: external ecore.EAttribute provided-by association external ecore.EClass.eAllAttributes\n"
    + "\t\t\t\tSynchronized\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tLabel { content: Java getAttributeName police: black }\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tFlatStyle {\tborder: blue background: light_gray }\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t\tContains {\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\tNode newNode {\n"
    + "\t\t\t\t\t\tdomain-context: external ecore.EAnnotation provided-by association external ecore.EClass.eAllSuperTypes\n"
    + "\t\t\t\t\t\tNot_Synchronized\n"
    + "\t\t\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\t\t\tLabel { content: \"example\" police: black alignment: center}\n"
    + "\t\t\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\t\t\tBasicStyle { border-color: black background: light_gray form: Square }\n"
    + "\t\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\tContains {\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t\tEdge newEdge {\n"
    + "\t\t\t\tassociation-context: external ecore.EAnnotation.contents\n"
    + "\t\t\t\tsource: containerExample\n"
    + "\t\t\t\ttarget: containerExample\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle { end-decorator: OutputArrow color: black }\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\tEdgeImport newEdgeImport {\n"
    + "\t\t\t\timport: EC_EReference\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tbegin-decorator: Diamond color: blue\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t}\n"
    + "\t\tActions{\n"
    + "\t\t\t//[Actions]\n"
    + "\t\t}\n"
    + "\t}\n"
    + "\t\n"
    + "}" | verify-true
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    hover-text 31 33
    set-caret-pos 31 37
    select-range 31 25 31 41
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property "getSelectionText()" | equals "Not_Synchronized" 
    | verify-true
get-button "Save (M1+S)" | click

//Workaround to force the sync between text and vpdesc
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.spec.vptext" 
    | get-menu "Viewpoint DSL/Generate vpdesc file" | click
    
wait -ms 5000

get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" 
    | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" | double-click
get-editor "example.vpdesc" | get-tree 
    | get-item "platform:\\/resource\\/org.polarsys.kitalpha.vp.example.vpdsl\\/model\\/example.vpdesc/Viewpoint example/Diagram Set example.diagram/Diagram diagram_example/Mapping Set/Container containerExample/Children/Node newNode" 
    | click
with [get-view Properties | get-tree] {
    get-item "Synchronization Mode" | get-property caption | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "values['Property']" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "values['Value']" | equals "Not_Synchronized" | verify-true
    get-item "Synchronization Mode" | get-property "getText()" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getData().getValueAsString()" | equals "Not_Synchronized" 
        | verify-true
}
get-editor "example.vpdesc" | close
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 46 73
    key-type Enter
    key-type "M1+SPACE"
}
get-window -from "CompletionProposalPopup.createProposalSelector()" | get-table 
    | select "Unsynchronizable - The Synchronization Of The Mapping Depends On the Synchronization Defined By The User" 
    | click -default
get-editor "example.diagram.vptext" | get-text-viewer | get-property text | equals "/**\n"
    + " * Copyright (c) PolarSys, 2016. All rights reserved. \n"
    + " *\n"
    + " *\tViewpoint example\n"
    + " *\t@author: S0045853\n"
    + " *\t@date: 05/07/16\n"
    + " *\n"
    + " */\n \n"
    + "import external  \"platform:/plugin/org.eclipse.emf.ecoretools.design/description/ecore.odesign\"\n"
    + "Diagrams example.diagram {\n"
    + "\t\n"
    + "\tDiagram \"diagram_example\" {\n"
    + "\t\tdomain-context: external ecore.EClass\n"
    + "\t\tMapping {\n"
    + "\t\t\t\n"
    + "\t\t\tContainer containerExample {\n"
    + "\t\t\t\tdomain-context: external ecore.EAttribute provided-by association external ecore.EClass.eAllAttributes\n"
    + "\t\t\t\tSynchronized\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tLabel { content: Java getAttributeName police: black }\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tFlatStyle {\tborder: blue background: light_gray }\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t\tContains {\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\tNode newNode {\n"
    + "\t\t\t\t\t\tdomain-context: external ecore.EAnnotation provided-by association external ecore.EClass.eAllSuperTypes\n"
    + "\t\t\t\t\t\tNot_Synchronized\n"
    + "\t\t\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\t\t\tLabel { content: \"example\" police: black alignment: center}\n"
    + "\t\t\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\t\t\tBasicStyle { border-color: black background: light_gray form: Square }\n"
    + "\t\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\tContains {\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t\tEdge newEdge {\n"
    + "\t\t\t\tassociation-context: external ecore.EAnnotation.contents\n"
    + "\t\t\t\tUnsynchronizable\n"
    + "\t\t\t\tsource: containerExample\n"
    + "\t\t\t\ttarget: containerExample\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle { end-decorator: OutputArrow color: black }\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\tEdgeImport newEdgeImport {\n"
    + "\t\t\t\timport: EC_EReference\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tbegin-decorator: Diamond color: blue\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t}\n"
    + "\t\tActions{\n"
    + "\t\t\t//[Actions]\n"
    + "\t\t}\n"
    + "\t}\n"
    + "\t\n"
    + "}" | verify-true
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 47 18
    select-range 47 17 47 33
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property "getSelectionText()" | equals Unsynchronizable 
    | verify-true
get-button "Save (M1+S)" | click

//Workaround to force the sync between text and vpdesc
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.spec.vptext" 
    | get-menu "Viewpoint DSL/Generate vpdesc file" | click
    
wait -ms 5000

get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" 
    | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" | double-click
get-editor "example.vpdesc" | get-tree 
    | get-item "platform:\\/resource\\/org.polarsys.kitalpha.vp.example.vpdsl\\/model\\/example.vpdesc/Viewpoint example/Diagram Set example.diagram/Diagram diagram_example/Mapping Set/Edge newEdge" 
    | click
with [get-view Properties | get-tree] {
    get-item "Synchronization Mode" | get-property caption | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getText()" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getData().getValueAsString()" | equals Unsynchronizable 
        | verify-true
}

get-editor "example.vpdesc" | get-tree 
    | get-item "platform:\\/resource\\/org.polarsys.kitalpha.vp.example.vpdsl\\/model\\/example.vpdesc/Viewpoint example/Diagram Set example.diagram/Diagram diagram_example/Mapping Set/Edge Import newEdgeImport" 
    | click
with [get-view Properties | get-tree] {
    get-item "Synchronization Mode" | get-property caption | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getText()" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getData().getValueAsString()" | equals Unsynchronizable 
        | verify-true
}
get-editor "example.vpdesc" | close
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 56 38
    key-type Enter
    key-type "M1+SPACE"
    key-type Down
    key-type Enter
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property text | equals "/**\n"
    + " * Copyright (c) PolarSys, 2016. All rights reserved. \n"
    + " *\n"
    + " *\tViewpoint example\n"
    + " *\t@author: S0045853\n"
    + " *\t@date: 05/07/16\n"
    + " *\n"
    + " */\n \n"
    + "import external  \"platform:/plugin/org.eclipse.emf.ecoretools.design/description/ecore.odesign\"\n"
    + "Diagrams example.diagram {\n"
    + "\t\n"
    + "\tDiagram \"diagram_example\" {\n"
    + "\t\tdomain-context: external ecore.EClass\n"
    + "\t\tMapping {\n"
    + "\t\t\t\n"
    + "\t\t\tContainer containerExample {\n"
    + "\t\t\t\tdomain-context: external ecore.EAttribute provided-by association external ecore.EClass.eAllAttributes\n"
    + "\t\t\t\tSynchronized\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tLabel { content: Java getAttributeName police: black }\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tFlatStyle {\tborder: blue background: light_gray }\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t\tContains {\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\t\n"
    + "\t\t\t\t\tNode newNode {\n"
    + "\t\t\t\t\t\tdomain-context: external ecore.EAnnotation provided-by association external ecore.EClass.eAllSuperTypes\n"
    + "\t\t\t\t\t\tNot_Synchronized\n"
    + "\t\t\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\t\t\tLabel { content: \"example\" police: black alignment: center}\n"
    + "\t\t\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\t\t\tBasicStyle { border-color: black background: light_gray form: Square }\n"
    + "\t\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t\tContains {\n"
    + "\t\t\t\t\t\t}\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t\tEdge newEdge {\n"
    + "\t\t\t\tassociation-context: external ecore.EAnnotation.contents\n"
    + "\t\t\t\tUnsynchronizable\n"
    + "\t\t\t\tsource: containerExample\n"
    + "\t\t\t\ttarget: containerExample\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle { end-decorator: OutputArrow color: black }\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\tEdgeImport newEdgeImport {\n"
    + "\t\t\t\timport: EC_EReference\n"
    + "\t\t\t\tSynchronized\n"
    + "\t\t\t\tRepresentation {\n"
    + "\t\t\t\t\tStyle {\n"
    + "\t\t\t\t\t\tbegin-decorator: Diamond color: blue\n"
    + "\t\t\t\t\t}\n"
    + "\t\t\t\t}\n"
    + "\t\t\t}\n"
    + "\t\t\t\n"
    + "\t\t\t\n"
    + "\t\t}\n"
    + "\t\tActions{\n"
    + "\t\t\t//[Actions]\n"
    + "\t\t}\n"
    + "\t}\n"
    + "\t\n"
    + "}" | verify-true
with [get-editor "example.diagram.vptext" | get-text-viewer] {
    set-caret-pos 57 18
    select-range 57 17 57 29
}
get-editor "example.diagram.vptext" | get-text-viewer | get-property "getSelectionText()" | equals Synchronized 
    | verify-true
get-button "Save (M1+S)" | click

//Workaround to force the sync between text and vpdesc
get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.spec.vptext" 
    | get-menu "Viewpoint DSL/Generate vpdesc file" | click
    
wait -ms 5000

get-view "Project Explorer" | get-tree | select "org.polarsys.kitalpha.vp.example.vpdsl/model/example.vpdesc" 
    | double-click
get-editor "example.vpdesc" | get-tree 
    | get-item "platform:\\/resource\\/org.polarsys.kitalpha.vp.example.vpdsl\\/model\\/example.vpdesc/Viewpoint example/Diagram Set example.diagram/Diagram diagram_example/Mapping Set/Edge Import newEdgeImport" 
    | click
with [get-view Properties | get-tree] {
    get-item "Synchronization Mode" | get-property caption | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getText()" | equals "Synchronization Mode" | verify-true
    get-item "Synchronization Mode" | get-property "getData().getValueAsString()" | equals Synchronized | verify-true
}
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
